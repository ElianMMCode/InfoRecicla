<!-- Fragment: Perfil Punto ECA -->
<section th:fragment="perfil" class="container-fluid py-4">
    <!-- Header con t√≠tulo mejorado - Colores acompa√±antes -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="d-flex align-items-center justify-content-between bg-gradient p-4 rounded-4 shadow-lg" style="background: linear-gradient(135deg, #198754 0%, #20c997 100%); border-left: 5px solid #0f5132;">
                <div>
                    <h2 class="h3 mb-2 fw-bold d-flex align-items-center" style="color: #0f5132;">
                        <i class="bi bi-file-earmark-person me-3 fs-4" style="color: #0f5132;"></i>Perfil del Punto ECA
                    </h2>
                    <p class="mb-0 fw-500" style="color: #0f5132;">
                        <i class="bi bi-info-circle me-2" style="color: #0f5132;"></i>Gestiona la informaci√≥n del encargado y datos del punto
                    </p>
                </div>
                <div class="text-end">
                    <span class="badge bg-white text-success fs-6 px-3 py-2">
                        <i class="bi bi-pencil me-1"></i>En edici√≥n
                    </span>
                </div>
            </div>
        </div>
    </div>

    <!-- Formulario √∫nico -->
    <!--/*@thymesVar id="usuario" type="org.sena.inforecicla.dto.usuario.UsuarioGestorResponseDTO"*/-->
    <form id="perfilForm" th:action="@{/punto-eca/{id}(id=${usuario.usuarioId})}" method="post" enctype="multipart/form-data">
        <input type="hidden" th:if="${_csrf != null}" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
        <input type="hidden" name="usuarioId" th:value="${usuario.usuarioId}" />

        <div class="row g-4">
            <div class="col-12">
                <div class="card border-0 shadow-lg rounded-4" style="border-top: 4px solid #198754; overflow: hidden;">
                    <!-- Nav Tabs mejorada -->
                    <div class="card-header bg-light p-0 border-bottom border-success border-opacity-25">
                        <ul class="nav nav-tabs" role="tablist" style="border-bottom: none;">
                            <li class="nav-item" role="presentation" style="margin-right: 1rem;">
                                <button class="nav-link active" id="pills-encargado-tab" data-bs-toggle="pill" data-bs-target="#pills-encargado" type="button" role="tab" aria-controls="pills-encargado" aria-selected="true" style="border: none; padding: 1rem 1.5rem; font-weight: 500;">
                                    <i class="bi bi-person-circle me-2 text-success"></i>Encargado
                                </button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="pills-punto-tab" data-bs-toggle="pill" data-bs-target="#pills-punto" type="button" role="tab" aria-controls="pills-punto" aria-selected="false" style="border: none; padding: 1rem 1.5rem; font-weight: 500;">
                                    <i class="bi bi-geo-alt-fill me-2 text-success"></i>Punto ECA
                                </button>
                            </li>
                        </ul>
                    </div>

                    <!-- Tab Content -->
                    <div class="tab-content card-body p-4">
                        <!-- TAB 1: ENCARGADO -->
                        <div class="tab-pane fade show active" id="pills-encargado" role="tabpanel" aria-labelledby="pills-encargado-tab">
                            <!-- Secci√≥n de foto de perfil -->
                            <div class="text-center mb-4">
                                <div class="position-relative d-inline-block">
                                    <img id="previewPerfil"
                                         th:src="${usuario.fotoPerfil != null ? usuario.fotoPerfil : '/imagenes/perfil_default.png'}"
                                         alt="Foto encargado"
                                         class="rounded-circle img-thumbnail border-3 border-success shadow"
                                         style="width:140px;height:140px;object-fit:cover;">
                                    <div class="position-absolute bottom-0 end-0 bg-success rounded-circle p-2">
                                        <i class="bi bi-camera text-white"></i>
                                    </div>
                                </div>
                                <div class="mt-3">
                                    <label for="fotoPerfil" class="form-label fw-semibold text-success">
                                        <i class="bi bi-upload me-1"></i>Actualizar foto de perfil
                                    </label>
                                    <input class="form-control form-control-lg" type="file" id="fotoPerfil" name="fotoPerfil" accept="image/*">
                                </div>
                            </div>

                            <div class="row g-3">
                                <!-- Nombres y Apellidos en una fila -->
                                <div class="col-md-6">
                                    <div class="form-floating">
                                        <input type="text" class="form-control form-control-lg border-2" id="nombres" name="nombres" th:value="${usuario.nombres}" placeholder="Nombres">
                                        <label for="nombres" class="text-muted">
                                            <i class="bi bi-person me-1"></i>Nombres
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-floating">
                                        <input type="text" class="form-control form-control-lg border-2" id="apellidos" name="apellidos" th:value="${usuario.apellidos}" placeholder="Apellidos">
                                        <label for="apellidos" class="text-muted">
                                            <i class="bi bi-person me-1"></i>Apellidos
                                        </label>
                                    </div>
                                </div>

                                <!-- Email y tel√©fono -->
                                <div class="col-md-6">
                                    <div class="form-floating">
                                        <input type="email" class="form-control form-control-lg border-2" id="email" name="email" th:value="${usuario.email}" placeholder="correo@ejemplo.com">
                                        <label for="email" class="text-muted">
                                            <i class="bi bi-envelope me-1"></i>Correo electr√≥nico
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-floating">
                                        <input type="tel" class="form-control form-control-lg border-2" id="celular" name="celular" th:value="${usuario.celular}" placeholder="Tel√©fono">
                                        <label for="celular" class="text-muted">
                                            <i class="bi bi-telephone me-1"></i>Tel√©fono / Celular
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <hr class="my-4">

                            <!-- Informaci√≥n adicional -->
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <div class="form-floating">
                                        <select class="form-select form-control-lg border-2" id="tipoUsuario" name="tipoUsuario">
                                            <option value="Admin" th:selected="${usuario.tipoUsuario?.name() == 'Admin'}">Administrador</option>
                                            <option value="GestorECA" th:selected="${usuario.tipoUsuario?.name() == 'GestorECA'}">Gestor ECA</option>
                                            <option value="Ciudadano" th:selected="${usuario.tipoUsuario?.name() == 'Ciudadano'}">Ciudadano</option>
                                        </select>
                                        <label for="tipoUsuario" class="text-muted">
                                            <i class="bi bi-person-badge me-1"></i>Tipo de usuario
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-floating">
                                        <select class="form-select form-control-lg border-2" id="tipoDocumento" name="tipoDocumento">
                                            <option value="CC" th:selected="${usuario.tipoDocumento?.name() == 'CC'}">C√©dula de Ciudadan√≠a</option>
                                            <option value="TI" th:selected="${usuario.tipoDocumento?.name() == 'TI'}">Tarjeta de Identidad</option>
                                            <option value="CE" th:selected="${usuario.tipoDocumento?.name() == 'CE'}">C√©dula de Extranjer√≠a</option>
                                            <option value="PP" th:selected="${usuario.tipoDocumento?.name() == 'PP'}">Pasaporte</option>
                                        </select>
                                        <label for="tipoDocumento" class="text-muted">
                                            <i class="bi bi-card-text me-1"></i>Tipo de documento
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-floating">
                                        <input type="text" class="form-control form-control-lg border-2" id="numeroDocumento" name="numeroDocumento" th:value="${usuario.numeroDocumento}" placeholder="N√∫mero">
                                        <label for="numeroDocumento" class="text-muted">
                                            <i class="bi bi-123 me-1"></i>N√∫mero de documento
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-floating">
                                        <input type="date" class="form-control form-control-lg border-2" id="fechaNacimiento" name="fechaNacimiento" th:value="${usuario.fechaNacimiento}">
                                        <label for="fechaNacimiento" class="text-muted">
                                            <i class="bi bi-calendar-date me-1"></i>Fecha de nacimiento
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <div class="mt-3">
                                <label for="biografia" class="form-label fw-semibold text-muted">
                                    <i class="bi bi-chat-square-text me-1"></i>Biograf√≠a
                                </label>
                                <textarea class="form-control form-control-lg border-2" id="biografia" name="biografia" rows="4" placeholder="Descripci√≥n breve del encargado...">[[${usuario.biografia}]]</textarea>
                            </div>
                        </div>

                        <!-- TAB 2: PUNTO ECA -->
                        <div class="tab-pane fade" id="pills-punto" role="tabpanel" aria-labelledby="pills-punto-tab">
                            <!-- Secci√≥n de foto del punto -->
                            <div class="text-center mb-4">
                                <div class="position-relative d-inline-block">
                                    <img id="previewPunto"
                                         th:src="${usuario.fotoPunto() != null ? usuario.fotoPunto : '/imagenes/eca-default.png'}"
                                         alt="Foto del punto ECA"
                                         class="img-fluid rounded-3 img-thumbnail border-3 border-info shadow"
                                         style="max-height:160px; object-fit:cover;">
                                    <div class="position-absolute bottom-0 end-0 bg-info rounded-circle p-2">
                                        <i class="bi bi-building text-white"></i>
                                    </div>
                                </div>
                                <div class="mt-3">
                                    <label for="fotoPunto" class="form-label fw-semibold text-info">
                                        <i class="bi bi-upload me-1"></i>Actualizar foto del punto
                                    </label>
                                    <input class="form-control form-control-lg" type="file" id="fotoPunto" name="fotoPunto" accept="image/*">
                                </div>
                            </div>

                            <!-- ID del punto (readonly con badge) -->
                            <div class="alert alert-light border-info border-2 mb-4">
                                <div class="d-flex align-items-center">
                                    <i class="bi bi-hash text-info me-2"></i>
                                    <div>
                                        <strong class="text-info">ID del Punto ECA</strong>
                                        <div class="font-monospace text-muted" th:text="${usuario.puntoEcaId ?: 'No asignado'}">ID</div>
                                    </div>
                                </div>
                                <input type="hidden" name="puntoEcaId" th:value="${usuario.puntoEcaId}">
                            </div>

                            <!-- Informaci√≥n b√°sica del punto -->
                            <div class="row g-3">
                                <div class="col-12">
                                    <div class="form-floating">
                                        <input type="text" class="form-control form-control-lg border-2" id="nombrePunto" name="nombrePunto" th:value="${usuario.nombrePunto}" placeholder="Nombre del punto">
                                        <label for="nombrePunto" class="text-muted">
                                            <i class="bi bi-building me-1"></i>Nombre del Punto
                                        </label>
                                    </div>
                                </div>
                                <div class="col-12">
                                    <div class="form-floating">
                                        <input type="text" class="form-control form-control-lg border-2" id="direccionPunto" name="direccionPunto" th:value="${usuario.direccionPunto}" placeholder="Direcci√≥n">
                                        <label for="direccionPunto" class="text-muted">
                                            <i class="bi bi-geo-alt me-1"></i>Direcci√≥n completa
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <hr class="my-4">

                            <!-- Ubicaci√≥n geogr√°fica -->
                            <h6 class="text-muted mb-3 fw-semibold">
                                <i class="bi bi-map me-1"></i>Ubicaci√≥n Geogr√°fica
                            </h6>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <div class="form-floating">
                                        <input type="text" class="form-control form-control-lg border-2" id="ciudadPunto" name="ciudadPunto" th:value="${usuario.ciudad ?: ''}" placeholder="Ciudad">
                                        <label for="ciudadPunto" class="text-muted">
                                            <i class="bi bi-buildings me-1"></i>Ciudad
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-floating">
                                        <select class="form-select form-control-lg border-2" id="localidadPunto" name="localidadPunto">
                                            <option value="">Seleccione una localidad</option>
                                            <option value="USAQUEN" th:selected="${usuario.localidadBogota?.name() == 'USAQUEN'}">Usaqu√©n</option>
                                            <option value="CHAPINERO" th:selected="${usuario.localidadBogota?.name() == 'CHAPINERO'}">Chapinero</option>
                                            <option value="SANTA_FE" th:selected="${usuario.localidadBogota?.name() == 'SANTA_FE'}">Santa Fe</option>
                                            <option value="SAN_CRISTOBAL" th:selected="${usuario.localidadBogota?.name() == 'SAN_CRISTOBAL'}">San Crist√≥bal</option>
                                            <option value="USME" th:selected="${usuario.localidadBogota?.name() == 'USME'}">Usme</option>
                                            <option value="TUNJUELITO" th:selected="${usuario.localidadBogota?.name() == 'TUNJUELITO'}">Tunjuelito</option>
                                            <option value="BOSA" th:selected="${usuario.localidadBogota?.name() == 'BOSA'}">Bosa</option>
                                            <option value="KENNEDY" th:selected="${usuario.localidadBogota?.name() == 'KENNEDY'}">Kennedy</option>
                                            <option value="FONTIBON" th:selected="${usuario.localidadBogota?.name() == 'FONTIBON'}">Fontib√≥n</option>
                                            <option value="ENGATIVA" th:selected="${usuario.localidadBogota?.name() == 'ENGATIVA'}">Engativ√°</option>
                                            <option value="SUBA" th:selected="${usuario.localidadBogota?.name() == 'SUBA'}">Suba</option>
                                            <option value="BARRIOS_UNIDOS" th:selected="${usuario.localidadBogota?.name() == 'BARRIOS_UNIDOS'}">Barrios Unidos</option>
                                            <option value="TEUSAQUILLO" th:selected="${usuario.localidadBogota?.name() == 'TEUSAQUILLO'}">Teusaquillo</option>
                                            <option value="LOS_MARTIRES" th:selected="${usuario.localidadBogota?.name() == 'LOS_MARTIRES'}">Los M√°rtires</option>
                                            <option value="ANTONIO_NARINO" th:selected="${usuario.localidadBogota?.name() == 'ANTONIO_NARINO'}">Antonio Nari√±o</option>
                                            <option value="PUENTE_ARANDA" th:selected="${usuario.localidadBogota?.name() == 'PUENTE_ARANDA'}">Puente Aranda</option>
                                            <option value="LA_CANDELARIA" th:selected="${usuario.localidadBogota?.name() == 'LA_CANDELARIA'}">La Candelaria</option>
                                            <option value="RAFAEL_URIBE_URIBE" th:selected="${usuario.localidadBogota?.name() == 'RAFAEL_URIBE_URIBE'}">Rafael Uribe Uribe</option>
                                            <option value="CIUDAD_BOLIVAR" th:selected="${usuario.localidadBogota?.name() == 'CIUDAD_BOLIVAR'}">Ciudad Bol√≠var</option>
                                            <option value="SUMAPAZ" th:selected="${usuario.localidadBogota?.name() == 'SUMAPAZ'}">Sumapaz</option>
                                        </select>
                                        <label for="localidadPunto" class="text-muted">
                                            <i class="bi bi-pin-map me-1"></i>Localidad
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <!-- Coordenadas con bot√≥n de geolocalizaci√≥n -->
                            <div class="mt-3">
                                <label for="coordenadas" class="form-label fw-semibold text-muted">
                                    <i class="bi bi-crosshair me-1"></i>Coordenadas GPS
                                </label>
                                <div class="input-group input-group-lg">
                                    <span class="input-group-text bg-light border-2">
                                        <i class="bi bi-geo-fill text-muted"></i>
                                    </span>
                                    <input type="text" class="form-control border-2" id="coordenadas" name="coordenadas" th:value="${usuario.coordenadasPunto ?: ''}" placeholder="Latitud, Longitud">
                                    <button class="btn btn-outline-info border-2 px-4" type="button" id="btnUbicacion">
                                        <i class="bi bi-crosshair2 me-1"></i>Obtener ubicaci√≥n
                                    </button>
                                </div>
                                <div class="form-text">
                                    <i class="bi bi-info-circle me-1"></i>
                                    Usa el bot√≥n para obtener autom√°ticamente las coordenadas de tu ubicaci√≥n actual
                                </div>
                            </div>

                            <hr class="my-4">

                            <!-- Informaci√≥n adicional del punto -->
                            <h6 class="text-muted mb-3 fw-semibold">
                                <i class="bi bi-info-circle me-1"></i>Informaci√≥n Adicional
                            </h6>

                            <!-- Descripci√≥n del punto -->
                            <div class="mb-3">
                                <label for="descripcionPunto" class="form-label fw-semibold text-muted">
                                    <i class="bi bi-card-text me-1"></i>Descripci√≥n del Punto ECA
                                </label>
                                <textarea class="form-control form-control-lg border-2" id="descripcionPunto" name="descripcionPunto" rows="3" placeholder="Descripci√≥n detallada del punto ECA..." th:value="${usuario.descripcionPunto ?: ''}"></textarea>
                            </div>

                            <!-- Tel√©fonos de contacto del punto -->
                            <div class="row g-3 mb-3">
                                <div class="col-md-6">
                                    <div class="form-floating">
                                        <input type="tel" class="form-control form-control-lg border-2" id="telefonoPunto" name="telefonoPunto" th:value="${usuario.telefonoPunto ?: ''}" placeholder="Tel√©fono fijo">
                                        <label for="telefonoPunto" class="text-muted">
                                            <i class="bi bi-telephone me-1"></i>Tel√©fono del Punto
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-floating">
                                        <input type="url" class="form-control form-control-lg border-2" id="logoPunto" name="logoPunto" th:value="${usuario.logoUrlPunto ?: ''}" placeholder="URL del logo">
                                        <label for="logoPunto" class="text-muted">
                                            <i class="bi bi-image me-1"></i>URL del Logo
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <!-- Logo del punto (preview) -->
                            <div class="text-center mb-3" th:if="${usuario.logoUrlPunto != null and !#strings.isEmpty(usuario.logoUrlPunto)}">
                                <div class="card border-2 border-info bg-light p-3 d-inline-block">
                                    <label class="form-label fw-semibold text-info mb-2">
                                        <i class="bi bi-award me-1"></i>Logo del Punto ECA
                                    </label>
                                    <div>
                                        <img th:src="${usuario.logoUrlPunto}"
                                             alt="Logo del punto ECA"
                                             class="img-fluid rounded shadow-sm"
                                             style="max-height:80px; max-width:200px; object-fit:contain;">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Botones de acci√≥n estilizados -->
        <div class="row mt-5">
            <div class="col-12">
                <div class="d-flex justify-content-center gap-3">
                    <button class="btn btn-success btn-lg shadow px-5 py-3" type="submit" name="action" value="guardar">
                        <i class="bi bi-check-circle me-2"></i>Guardar Cambios
                    </button>
                    <button class="btn btn-outline-primary btn-lg px-5 py-3" type="submit" name="action" value="actualizar">
                        <i class="bi bi-arrow-clockwise me-2"></i>Actualizar
                    </button>
                    <button class="btn btn-outline-secondary btn-lg px-4 py-3" type="button" onclick="history.back()">
                        <i class="bi bi-arrow-left me-2"></i>Cancelar
                    </button>
                </div>
            </div>
        </div>
    </form>
</section>

<!-- Script mejorado con mejor UX -->
<script>
    // Previews para im√°genes con animaciones
    (function(){
        const fotoPerfil = document.getElementById('fotoPerfil');
        const fotoPunto = document.getElementById('fotoPunto');

        fotoPerfil?.addEventListener('change', function(e){
            const file = e.target.files[0];
            if(!file) return;
            const img = document.getElementById('previewPerfil');
            img.style.opacity = '0.5';
            setTimeout(() => {
                img.src = URL.createObjectURL(file);
                img.style.opacity = '1';
            }, 200);
        });

        fotoPunto?.addEventListener('change', function(e){
            const file = e.target.files[0];
            if(!file) return;
            const img = document.getElementById('previewPunto');
            img.style.opacity = '0.5';
            setTimeout(() => {
                img.src = URL.createObjectURL(file);
                img.style.opacity = '1';
            }, 200);
        });

        // Geolocalizaci√≥n con mejor feedback
        document.getElementById('btnUbicacion')?.addEventListener('click', function(){
            const btn = this;
            const originalText = btn.innerHTML;

            if(!navigator.geolocation) {
                alert('Geolocalizaci√≥n no soportada en este navegador');
                return;
            }

            // Mostrar loading
            btn.innerHTML = '<span class="spinner-border spinner-border-sm me-1"></span>Obteniendo...';
            btn.disabled = true;

            navigator.geolocation.getCurrentPosition(pos => {
                const lat = pos.coords.latitude.toFixed(6);
                const lon = pos.coords.longitude.toFixed(6);
                document.getElementById('coordenadas').value = lat + ', ' + lon;

                // Restaurar bot√≥n
                btn.innerHTML = '<i class="bi bi-check-circle me-1"></i>¬°Obtenido!';
                setTimeout(() => {
                    btn.innerHTML = originalText;
                    btn.disabled = false;
                }, 2000);
            }, err => {
                alert('No se pudo obtener la ubicaci√≥n: ' + err.message);
                btn.innerHTML = originalText;
                btn.disabled = false;
            });
        });

        // A√±adir transiciones suaves a los elementos del formulario
        document.querySelectorAll('.form-control, .form-select').forEach(input => {
            input.style.transition = 'all 0.3s ease';
            input.addEventListener('focus', function() {
                this.style.transform = 'scale(1.02)';
                this.style.boxShadow = '0 0 0 0.25rem rgba(13, 110, 253, 0.25)';
            });
            input.addEventListener('blur', function() {
                this.style.transform = 'scale(1)';
                this.style.boxShadow = '';
            });
        });
    })();
</script>

<!-- Script para activar pesta√±as - BOOTSTRAP + FALLBACK -->
<script>
/* Estilos para las pesta√±as con colores verdes */
const style = document.createElement('style');
style.textContent = `
    .nav-link {
        color: #6c757d !important;
        border-bottom: 3px solid transparent !important;
        transition: all 0.3s ease !important;
    }

    .nav-link:hover {
        color: #198754 !important;
        border-bottom-color: #d4e7dd !important;
    }

    .nav-link.active {
        color: #198754 !important;
        border-bottom-color: #198754 !important;
        background-color: transparent !important;
        font-weight: 600;
    }

    .tab-pane {
        animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(5px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
`;
document.head.appendChild(style);

(function() {
    console.log('üîß Script de pesta√±as inicializando...');

    function initTabs() {
        const tabButtons = document.querySelectorAll('[data-bs-toggle="pill"]');
        console.log('üìå Botones de pesta√±a encontrados:', tabButtons.length);

        if (tabButtons.length === 0) {
            console.warn('‚ö†Ô∏è No se encontraron botones de pesta√±a');
            return;
        }

        tabButtons.forEach((button, index) => {
            console.log(`üìç Bot√≥n ${index + 1}:`, button.id);

            button.addEventListener('click', function(e) {
                console.log('‚úÖ Click en pesta√±a:', this.id);
                e.preventDefault();
                e.stopPropagation();

                const target = this.getAttribute('data-bs-target');
                console.log('üéØ Target:', target);

                if (!target) {
                    console.error('‚ùå No hay target');
                    return;
                }

                // Intentar usar Bootstrap Tab API si est√° disponible
                if (window.bootstrap && bootstrap.Tab) {
                    try {
                        const tab = new bootstrap.Tab(this);
                        tab.show();
                        console.log('‚ú® Usando Bootstrap Tab API');
                        return;
                    } catch (err) {
                        console.log('‚ö†Ô∏è Bootstrap Tab API fall√≥, usando fallback');
                    }
                }

                // FALLBACK: Remover active de todos
                tabButtons.forEach(btn => {
                    btn.classList.remove('active');
                    btn.setAttribute('aria-selected', 'false');
                });

                document.querySelectorAll('.tab-pane').forEach(pane => {
                    pane.classList.remove('show', 'active');
                });

                // Agregar active al clickeado
                this.classList.add('active');
                this.setAttribute('aria-selected', 'true');

                // Mostrar pane
                const pane = document.querySelector(target);
                if (pane) {
                    pane.classList.add('show', 'active');
                    console.log('‚ú® Pesta√±a activada (fallback):', target);
                } else {
                    console.error('‚ùå Pane no encontrado:', target);
                }
            });
        });
    }

    // Intentar inicializar inmediatamente
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initTabs);
    } else {
        initTabs();
    }

    // Tambi√©n intentar despu√©s de un peque√±o delay
    setTimeout(initTabs, 100);
})();
</script>

<!-- A√±adir Bootstrap Icons CDN si no est√° incluido -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">

